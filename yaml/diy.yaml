# Clash 配置模板 - By Gemini
# 使用方法：将此文件上传到 Gist 或其他可直链访问的地方。
# 在订阅转换工具中，将此文件的 URL 填入“远程配置”或“模板”一栏。

port: 7890
socks-port: 7891
mixed-port: 7892
allow-lan: false
bind-address: "*"
mode: rule
log-level: error
ipv6: false
find-process-mode: strict
external-controller: 127.0.0.1:9090
profile:
  store-selected: true
  store-fake-ip: true
unified-delay: true
tcp-concurrent: true
global-ua: clash.meta

sniffer:
  enable: true
  force-dns-mapping: true
  parse-pure-ip: true
  override-destination: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-domain:
    - Mijia Cloud

ntp:
  enable: true
  write-to-system: false
  server: ntp.aliyun.com
  port: 123
  interval: 30

dns:
  enable: true
  prefer-h3: false
  listen: 0.0.0.0:1053
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - "+.lan"
    - "+.local"
    - localhost.ptlogin2.qq.com
    - "+.msftconnecttest.com"
    - "+.msftncsi.com"
    - "+.googleapis.com"
    - "+.googleapis.cn"
    - alt1-mtalk.google.com
    - alt2-mtalk.google.com
    - alt3-mtalk.google.com
    - alt4-mtalk.google.com
    - alt5-mtalk.google.com
    - alt6-mtalk.google.com
    - alt7-mtalk.google.com
    - alt8-mtalk.google.com
    - mtalk.google.com
  use-hosts: true
  default-nameserver:
    - '114.114.114.114#DIRECT'
    - '223.5.5.5#DIRECT'
    - '119.29.29.29#DIRECT'
    - '180.76.76.76#DIRECT'
    - '180.184.1.1#DIRECT'
  proxy-server-nameserver:
    - 'https://dns.alidns.com/dns-query#DIRECT'
    - 'https://doh.pub/dns-query#DIRECT'
    - 'https://doh.onedns.net/dns-query#DIRECT'
  nameserver:
    - "https://cloudflare-dns.com/dns-query#🌏️主要代理"
  nameserver-policy:
    "ntp.aliyun.com": "https://dns.alidns.com/dns-query#DIRECT"
    "+.jsdmirror.com": "https://dns.alidns.com/dns-query#DIRECT"
    "fastly.jsdelivr.net": "https://dns.alidns.com/dns-query#DIRECT"
    "proxy.sakuraikaede.com": "https://dns.alidns.com/dns-query#DIRECT"
    "converter-mitce.sakuraikaede.com": "https://dns.alidns.com/dns-query#DIRECT"
    "+.msftconnecttest.com,+.msftncsi.com": "https://cloudflare-dns.com/dns-query#🌏️主要代理"
    "+.googleapis.com,+.googleapis.cn": "https://cloudflare-dns.com/dns-query#🔍谷歌服务"
    "rule-set:Bahamut-Site": "https://cloudflare-dns.com/dns-query#🌸巴哈姆特"
    "rule-set:Bilibili-Site": "https://dns.alidns.com/dns-query#📺哔哩哔哩"
    "rule-set:Discord-Site": "https://cloudflare-dns.com/dns-query#🐟逗鱼平台"
    "rule-set:GoogleFCM-Site": "https://cloudflare-dns.com/dns-query#☁️谷歌推送"
    "rule-set:Netflix-Site": "https://cloudflare-dns.com/dns-query#📽️奈飞影视"
    "rule-set:OpenAI-Site": "https://cloudflare-dns.com/dns-query#🤖开放智能"
    "rule-set:Speedtest-Site": "https://cloudflare-dns.com/dns-query#⏱️网络测速"
    "rule-set:Spotify-Site": "https://cloudflare-dns.com/dns-query#🎵声田音乐"
    "rule-set:Steam-Site": "https://doh.pub/dns-query#🎮蒸汽平台"
    "rule-set:Telegram-Site": "https://cloudflare-dns.com/dns-query#✈️电报通讯"
    "rule-set:TikTok-Site": "https://cloudflare-dns.com/dns-query#🎶抖音国际"
    "rule-set:Apple-Site": "https://doh.pub/dns-query#🍎苹果服务"
    "rule-set:Google-Site": "https://cloudflare-dns.com/dns-query#🔍谷歌服务"
    "rule-set:Microsoft-Site": "https://doh.pub/dns-query#💻微软服务"
    "rule-set:GFWList-Site": "https://cloudflare-dns.com/dns-query#🧱墙外服务"
    "rule-set:China-Site": "https://dns.alidns.com/dns-query#🇨🇳国内服务"

tun:
  enable: true
  stack: system
  auto-route: true
  auto-detect-interface: true
  strict-route: true
  dns-hijack:
    - any:53
  device: SakuraiTunnel
  mtu: 9000
  endpoint-independent-nat: true

proxy-groups:
  - name: "🌏️主要代理"
    type: select
    proxies: ["♾️自动选择", "⚖️负载均衡", DIRECT, REJECT]

  - name: "🇨🇳国内服务"
    type: select
    proxies: [DIRECT, "🌏️主要代理", "♾️自动选择", "⚖️负载均衡", REJECT]

  - name: "🧱墙外服务"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", REJECT]

  - name: "🔍谷歌服务"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", REJECT]

  - name: "🍎苹果服务"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", DIRECT, REJECT]

  - name: "💻微软服务"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", DIRECT, REJECT]

  - name: "🌸巴哈姆特"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", REJECT]

  - name: "📺哔哩哔哩"
    type: select
    proxies: [DIRECT, "🌏️主要代理", "♾️自动选择", "⚖️负载均衡", REJECT]

  - name: "🐟逗鱼平台"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", REJECT]

  - name: "☁️谷歌推送"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", REJECT]

  - name: "📽️奈飞影视"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", REJECT]

  - name: "🤖开放智能"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", REJECT]

  - name: "⏱️网络测速"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", REJECT]

  - name: "🎵声田音乐"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", REJECT]

  - name: "🎮蒸汽平台"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", DIRECT, REJECT]

  - name: "✈️电报通讯"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", REJECT]

  - name: "🎶抖音国际"
    type: select
    proxies: ["🌏️主要代理", "♾️自动选择", "⚖️负载均衡", REJECT]

  - name: "⚖️负载均衡"
    type: load-balance
    url: "https://cp.cloudflare.com"
    interval: 180
    lazy: true
    strategy: consistent-hashing

  - name: "♾️自动选择"
    type: url-test
    url: "https://cp.cloudflare.com"
    interval: 180
    lazy: false

rule-providers:
  Apple-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Apple/Apple-Site.mrs"
    path: ./ruleset/Apple-Site.mrs
    proxy: DIRECT
    interval: 86400

  Apple-IP:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Apple/Apple-IP.mrs"
    path: ./ruleset/Apple-IP.mrs
    proxy: DIRECT
    interval: 86400

  Bahamut-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Bahamut/Bahamut-Site.mrs"
    path: ./ruleset/Bahamut-Site.mrs
    proxy: DIRECT
    interval: 86400

  Bilibili-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Bilibili/Bilibili-Site.mrs"
    path: ./ruleset/Bilibili-Site.mrs
    proxy: DIRECT
    interval: 86400

  Bilibili-IP:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Bilibili/Bilibili-IP.mrs"
    path: ./ruleset/Bilibili-IP.mrs
    proxy: DIRECT
    interval: 86400

  China-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/China/China-Site.mrs"
    path: ./ruleset/China-Site.mrs
    proxy: DIRECT
    interval: 86400

  China-IP:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/China/China-IP.mrs"
    path: ./ruleset/China-IP.mrs
    proxy: DIRECT
    interval: 86400

  Discord-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Discord/Discord-Site.mrs"
    path: ./ruleset/Discord-Site.mrs
    proxy: DIRECT
    interval: 86400

  GFWList-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/GFWList/GFWList-Site.mrs"
    path: ./ruleset/GFWList-Site.mrs
    proxy: DIRECT
    interval: 86400

  Google-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Google/Google-Site.mrs"
    path: ./ruleset/Google-Site.mrs
    proxy: DIRECT
    interval: 86400

  Google-IP:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Google/Google-IP.mrs"
    path: ./ruleset/Google-IP.mrs
    proxy: DIRECT
    interval: 86400

  GoogleFCM-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/GoogleFCM/GoogleFCM-Site.mrs"
    path: ./ruleset/GoogleFCM-Site.mrs
    proxy: DIRECT
    interval: 86400

  Local-IP:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Local/Local-IP.mrs"
    path: ./ruleset/Local-IP.mrs
    proxy: DIRECT
    interval: 86400

  Microsoft-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Microsoft/Microsoft-Site.mrs"
    path: ./ruleset/Microsoft-Site.mrs
    proxy: DIRECT
    interval: 86400

  Netflix-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Netflix/Netflix-Site.mrs"
    path: ./ruleset/Netflix-Site.mrs
    proxy: DIRECT
    interval: 86400

  Netflix-IP:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Netflix/Netflix-IP.mrs"
    path: ./ruleset/Netflix-IP.mrs
    proxy: DIRECT
    interval: 86400

  OpenAI-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/OpenAI/OpenAI-Site.mrs"
    path: ./ruleset/OpenAI-Site.mrs
    proxy: DIRECT
    interval: 86400

  OpenAI-IP:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/OpenAI/OpenAI-IP.mrs"
    path: ./ruleset/OpenAI-IP.mrs
    proxy: DIRECT
    interval: 86400

  Speedtest-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Speedtest/Speedtest-Site.mrs"
    path: ./ruleset/Speedtest-Site.mrs
    proxy: DIRECT
    interval: 86400

  Spotify-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Spotify/Spotify-Site.mrs"
    path: ./ruleset/Spotify-Site.mrs
    proxy: DIRECT
    interval: 86400

  Spotify-IP:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Spotify/Spotify-IP.mrs"
    path: ./ruleset/Spotify-IP.mrs
    proxy: DIRECT
    interval: 86400

  Steam-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Steam/Steam-Site.mrs"
    path: ./ruleset/Steam-Site.mrs
    proxy: DIRECT
    interval: 86400

  Telegram-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Telegram/Telegram-Site.mrs"
    path: ./ruleset/Telegram-Site.mrs
    proxy: DIRECT
    interval: 86400

  Telegram-IP:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/Telegram/Telegram-IP.mrs"
    path: ./ruleset/Telegram-IP.mrs
    proxy: DIRECT
    interval: 86400

  TikTok-Site:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdmirror.com/gh/HosheaPDNX/rule-set@V2.0.0/mihomo/TikTok/TikTok-Site.mrs"
    path: ./ruleset/TikTok-Site.mrs
    proxy: DIRECT
    interval: 86400

rules:
  - "AND,((DST-PORT,443),(NETWORK,UDP)),REJECT"
  - "DOMAIN,ntp.aliyun.com,DIRECT"
  - "DOMAIN,proxy.sakuraikaede.com,DIRECT"
  - "DOMAIN,converter-mitce.sakuraikaede.com,DIRECT"
  - "DOMAIN-KEYWORD,msftconnecttest.com,🌏️主要代理"
  - "DOMAIN-KEYWORD,msftncsi.com,🌏️主要代理"
  - "DOMAIN-KEYWORD,googleapis,🔍谷歌服务"
  - "RULE-SET,Bahamut-Site,🌸巴哈姆特"
  - "RULE-SET,Bilibili-Site,📺哔哩哔哩"
  - "RULE-SET,Discord-Site,🐟逗鱼平台"
  - "RULE-SET,GoogleFCM-Site,☁️谷歌推送"
  - "RULE-SET,Netflix-Site,📽️奈飞影视"
  - "RULE-SET,OpenAI-Site,🤖开放智能"
  - "RULE-SET,Speedtest-Site,⏱️网络测速"
  - "RULE-SET,Spotify-Site,🎵声田音乐"
  - "RULE-SET,Steam-Site,🎮蒸汽平台"
  - "RULE-SET,Telegram-Site,✈️电报通讯"
  - "RULE-SET,TikTok-Site,🎶抖音国际"
  - "RULE-SET,Apple-Site,🍎苹果服务"
  - "RULE-SET,Google-Site,🔍谷歌服务"
  - "RULE-SET,Microsoft-Site,💻微软服务"
  - "RULE-SET,GFWList-Site,🧱墙外服务"
  - "RULE-SET,China-Site,🇨🇳国内服务"
  - "RULE-SET,Local-IP,DIRECT,no-resolve"
  - "RULE-SET,Bilibili-IP,📺哔哩哔哩"
  - "RULE-SET,Netflix-IP,📽️奈飞影视"
  - "RULE-SET,OpenAI-IP,🤖开放智能"
  - "RULE-SET,Spotify-IP,🎵声田音乐"
  - "RULE-SET,Telegram-IP,✈️电报通讯"
  - "RULE-SET,Apple-IP,🍎苹果服务"
  - "RULE-SET,Google-IP,🔍谷歌服务"
  - "RULE-SET,China-IP,🇨🇳国内服务"
  - "MATCH,🌏️主要代理"
