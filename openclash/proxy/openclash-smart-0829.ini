; ###############################################################
; # Clash-ALL 订阅转换模板 (.ini 格式)
; # 说明：此文件为 subconverter 等订阅转换后端的配置文件。
; # 已适配 Clash.Meta 内核的 smart 策略组。
; ###############################################################

; ========================
; 1. 规则集定义 (ruleset)
; ========================
ruleset=Test,https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Check.list
ruleset=Block,https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Block.list
ruleset=GitHub,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/github.mrs
ruleset=人工智能,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/openai.mrs
ruleset=人工智能,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/cursor.mrs
ruleset=人工智能,https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Claude/Claude.list
ruleset=人工智能,https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Copilot.list
ruleset=人工智能,https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Gemini.list
ruleset=人工智能,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/groq.mrs
ruleset=人工智能,https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Grok.list
ruleset=人工智能,https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/MetaAi.list
ruleset=人工智能,https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Jetbrains/Jetbrains.list
ruleset=PPLX,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/perplexity.mrs
ruleset=微软服务,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/microsoft.mrs
ruleset=谷歌服务,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/google.mrs
ruleset=苹果服务,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/apple.mrs
ruleset=苹果中国,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/apple-cn.mrs
ruleset=金融货币,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/okx.mrs
ruleset=金融货币,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/bybit.mrs
ruleset=金融货币,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/binance.mrs
ruleset=金融货币,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/stripe.mrs
ruleset=国外视频,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/tiktok.mrs
ruleset=油管视频,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/youtube.mrs
ruleset=奈飞视频,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/netflix.mrs
ruleset=国外视频,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/disney.mrs
ruleset=国外视频,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/amazon.mrs
ruleset=国外视频,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/hbo.mrs
ruleset=国外视频,https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Crunchyroll.list
ruleset=国外视频,https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Popcorn.list
ruleset=国外视频,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/spotify.mrs
ruleset=社交平台,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/x.mrs
ruleset=社交平台,https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Whatsapp/Whatsapp.list
ruleset=社交平台,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/facebook.mrs
ruleset=社交平台,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/telegram.mrs
ruleset=游戏平台,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/steam.mrs
ruleset=游戏平台,https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Epic/Epic.list
ruleset=游戏平台,https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/EA/EA.list
ruleset=游戏平台,https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Blizzard/Blizzard.list
ruleset=游戏平台,https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/UBI/UBI.list
ruleset=游戏平台,https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/PlayStation/PlayStation.list
ruleset=游戏平台,https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Nintendo/Nintendo.list
ruleset=Reddit,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/reddit.mrs
ruleset=国外,https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Proxy.list
ruleset=国外,https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Global/Global.list
ruleset=国内,https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Direct.list
ruleset=国内,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/private.mrs
ruleset=国内,https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/cn.mrs
ruleset=其他,[]FINAL

; ========================
; 2. 自定义策略组 (custom_proxy_group)
; ========================

; --- 节点策略组 (筛选并填充节点) ---
custom_proxy_group=所有-手选`select`.*
custom_proxy_group=所有-智选`smart`.*
custom_proxy_group=香港-手选`select`(?=.*(广港|香港|HK|Hong Kong|🇭🇰|HongKong)).*$
custom_proxy_group=香港-智选`smart`(?=.*(广港|香港|HK|Hong Kong|🇭🇰|HongKong)).*$
custom_proxy_group=台湾-手选`select`(?=.*(广台|台湾|台灣|TW|Tai Wan|🇹🇼|🇨🇳|TaiWan|Taiwan)).*$
custom_proxy_group=台湾-智选`smart`(?=.*(广台|台湾|台灣|TW|Tai Wan|🇹🇼|🇨🇳|TaiWan|Taiwan)).*$
custom_proxy_group=日本-手选`select`(?=.*(广日|日本|JP|川日|东京|大阪|泉日|埼玉|沪日|深日|🇯🇵|Japan)).*$
custom_proxy_group=日本-智选`smart`(?=.*(广日|日本|JP|川日|东京|大阪|泉日|埼玉|沪日|深日|🇯🇵|Japan)).*$
custom_proxy_group=新加坡-手选`select`(?=.*(广新|新加坡|SG|坡|狮城|🇸🇬|Singapore)).*$
custom_proxy_group=新加坡-智选`smart`(?=.*(广新|新加坡|SG|坡|狮城|🇸🇬|Singapore)).*$
custom_proxy_group=美国-手选`select`(?=.*(广美|美|US|纽约|波特兰|达拉斯|俄勒|凤凰城|费利蒙|拉斯|洛杉|圣何塞|圣克拉|西雅|芝加|🇺🇸|United States)).*$
custom_proxy_group=美国-智选`smart`(?=.*(广美|美|US|纽约|波特兰|达拉斯|俄勒|凤凰城|费利蒙|拉斯|洛杉|圣何塞|圣克拉|西雅|芝加|🇺🇸|United States)).*$
custom_proxy_group=其他-手选`select`^((?!(直连|拒绝|广港|香港|HK|Hong Kong|🇭🇰|HongKong|广台|台湾|台灣|TW|Tai Wan|🇹🇼|🇨🇳|TaiWan|Taiwan|广日|日本|JP|川日|东京|大阪|泉日|埼玉|沪日|深日|🇯🇵|Japan|广新|新加坡|SG|坡|狮城|🇸🇬|Singapore|广美|美|US|纽约|波特兰|达拉斯|俄勒|凤凰城|费利蒙|拉斯|洛杉|圣何塞|圣克拉|西雅|芝加|🇺🇸|United States)).)*$
custom_proxy_group=其他-智选`smart`^((?!(直连|拒绝|广港|香港|HK|Hong Kong|🇭🇰|HongKong|广台|台湾|台灣|TW|Tai Wan|🇹🇼|🇨🇳|TaiWan|Taiwan|广日|日本|JP|川日|东京|大阪|泉日|埼玉|沪日|深日|🇯🇵|Japan|广新|新加坡|SG|坡|狮城|🇸🇬|Singapore|广美|美|US|纽约|波特兰|达拉斯|俄勒|凤凰城|费利蒙|拉斯|洛杉|圣何塞|圣克拉|西雅|芝加|🇺🇸|United States)).)*$

; --- 嵌套策略组 (组合上面已创建的组) ---
custom_proxy_group=香港-故转`fallback`[]香港-手选`[]香港-智选`http://www.gstatic.com/generate_204`180
custom_proxy_group=台湾-故转`fallback`[]台湾-手选`[]台湾-智选`http://www.gstatic.com/generate_204`180
custom_proxy_group=日本-故转`fallback`[]日本-手选`[]日本-智选`http://www.gstatic.com/generate_204`180
custom_proxy_group=新加坡-故转`fallback`[]新加坡-手选`[]新加坡-智选`http://www.gstatic.com/generate_204`180
custom_proxy_group=美国-故转`fallback`[]美国-手选`[]美国-智选`http://www.gstatic.com/generate_204`180
custom_proxy_group=其他-故转`fallback`[]其他-手选`[]其他-智选`http://www.gstatic.com/generate_204`180

; --- 业务分流组 (最终给用户选择的组) ---
custom_proxy_group=人工智能`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=PPLX`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=国外视频`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=油管视频`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=奈飞视频`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=GitHub`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=Reddit`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=社交平台`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=谷歌服务`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=苹果服务`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=苹果中国`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=微软服务`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=游戏平台`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=金融货币`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=测试平台`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=Block`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=国外`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=国内`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转
custom_proxy_group=其他`select`[]DIRECT`[]REJECT`[]所有-智选`[]所有-手选`[]香港-智选`[]香港-故转`[]台湾-故转`[]日本-故转`[]新加坡-故转`[]美国-故转`[]其他-故转

; ========================
; 3. 其他设置
; ========================
enable_rule_generator=true
overwrite_original_rules=true

; ###############################################################
; # 以下为注入到最终配置文件的静态 YAML 内容
; ###############################################################
port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893
tproxy-port: 7895
allow-lan: true
mode: rule
log-level: info
external-controller: 0.0.0.0:9090
secret: "123456"

dns:
  enable: true
  listen: 0.0.0.0:7874
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.20.0.1/16
  nameserver:
    - 223.5.5.5
  fake-ip-filter:
    - +.lan
    - +.local
    - geosite:cn
    - +.66jc.top
    - +.jueduibupao.top
    - +.ynhtbank.com
    - +.qeayr.cn
    - +.saojc.xyz
    - +.sssyun.xyz
    - +.dler.cloud
    - +.0tk8a3a1q4t94dler.com
    - +.aerianas.top
    - +.gptacg.top

tun:
  enable: true
  stack: gvisor
  device: utun
  endpoint-independent-nat: true
  auto-route: false
  auto-detect-interface: false
  auto-redirect: false
  strict-route: false

profile:
  store-selected: true
  store-fake-ip: true

# --- smart 策略组的详细参数定义 ---
# subconverter 会将 custom_proxy_group 指令填充的节点合并到这里定义的策略组中
proxy-groups:
  - name: 所有-智选
    type: smart
    proxies: [] # 此处留空，由 custom_proxy_group 填充
    policy-priority: ".*牛逼.*:0.8;.*(香港|HK).*:1.2;.*三线.*:1.5"
    uselightgbm: true
    collectdata: true
    health-check: 
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 60
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "^((?!(直连|拒绝|建议每次使用前都更新一下订阅|如果只显示此节点|是客户端太久导致|请到网站使用教程|更新一下客户端)).)*$"

  - name: 香港-智选
    type: smart
    proxies: []
    policy-priority: ".*牛逼.*:0.8"
    uselightgbm: true
    collectdata: true
    health-check: 
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 60
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "(?=.*(广港|香港|HK|Hong Kong|🇭🇰|HongKong)).*$"

  - name: 台湾-智选
    type: smart
    proxies: []
    policy-priority: ".*牛逼.*:0.8"
    uselightgbm: true
    collectdata: true
    health-check: 
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 60
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "(?=.*(广台|台湾|台灣|TW|Tai Wan|🇹🇼|🇨🇳|TaiWan|Taiwan)).*$"

  - name: 日本-智选
    type: smart
    proxies: []
    policy-priority: ".*牛逼.*:0.8"
    uselightgbm: true
    collectdata: true
    health-check: 
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 60
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "(?=.*(广日|日本|JP|川日|东京|大阪|泉日|埼玉|沪日|深日|🇯🇵|Japan)).*$"

  - name: 新加坡-智选
    type: smart
    proxies: []
    policy-priority: ".*牛逼.*:0.8"
    uselightgbm: true
    collectdata: true
    health-check: 
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 60
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "(?=.*(广新|新加坡|SG|坡|狮城|🇸🇬|Singapore)).*$"

  - name: 美国-智选
    type: smart
    proxies: []
    policy-priority: ".*牛逼.*:0.8"
    uselightgbm: true
    collectdata: true
    health-check: 
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 60
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "(?=.*(广美|美|US|纽约|波特兰|达拉斯|俄勒|凤凰城|费利蒙|拉斯|洛杉|圣何塞|圣克拉|西雅|芝加|🇺🇸|United States)).*$"

  - name: 其他-智选
    type: smart
    proxies: []
    policy-priority: ".*牛逼.*:0.8"
    uselightgbm: true
    collectdata: true
    health-check: 
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 60
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "^((?!(直连|拒绝|广港|香港|HK|Hong Kong|🇭🇰|HongKong|广台|台湾|台灣|TW|Tai Wan|🇹🇼|🇨🇳|TaiWan|Taiwan|广日|日本|JP|川日|东京|大阪|泉日|埼玉|沪日|深日|🇯🇵|Japan|广新|新加坡|SG|坡|狮城|🇸🇬|Singapore|广美|美|US|纽约|波特兰|达拉斯|俄勒|凤凰城|费利蒙|拉斯|洛杉|圣何塞|圣克拉|西雅|芝加|🇺🇸|United States)).)*$"
